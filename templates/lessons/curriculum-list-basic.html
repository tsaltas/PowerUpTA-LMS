{% extends 'base.html' %}

{% block ng_app %}lms.app.curricula{% endblock %}

{% block content %}

{% verbatim %}

<div ng-controller="CurriculumCtrl">

	<div class="first-element"></div>
	
	<div class="container">
		<h1>Curriculum list
			<small class="pull-right">Filter: <input ng-model="query"></small>
		</h1>
	</div>

	<div class="container curr-list">
		<accordion id="curr-accordion" close-others="oneAtATime">
			<div class="" ng-repeat="curriculum in curricula | filter:query">

				<div class="row">
					<div class="col-xs-1 col-center icon-pad-top">
						<i class="fa fa-globe fa-lg"></i>
					</div>
					<div class="col-sm-3">
						<h3 class="no-margin">{{curriculum.name}}</h3>
					</div>
					<div class="col-sm-8">
						<span class="pull-right icon-pad-top">
							<span ng-show="currEditLabel" >Edit Curriculum</span>
							<span ng-show="currPDFLabel">Export to PDF</span>
							<i class="fa fa-edit fa-md" ng-mouseenter="currEditLabel = true" ng-mouseleave="currEditLabel = false"></i>
							<i class="fa fa-file-pdf-o fa-md" ng-mouseenter="currPDFLabel = true" ng-mouseleave="currPDFLabel = false"></i>
						</span>

						<h4>Grades {{curriculum.lower_grade}}-{{curriculum.upper_grade}}, {{curriculum.tagline}}</h4>
						<p>{{curriculum.description}}</p>
						<span ng-show="notEmpty({{curriculum.tags}})" ng-repeat="tag in curriculum.tags">
							<img ng-src="{{tag.logo}}" alt="tag.name" class="img-thumbnail img-responsive">
						</span>
					</div>
					<accordion-group id="activity-group" heading="Lessons">
					<div ng-repeat="relationship in curriculum.activities">
						<div class="row">
							<div class="col-xs-offset-1 col-xs-2" ng-switch on="relationship.activity.category">
								<!-- Show appropriate logo for curriculum type -->
								<span ng-switch-when="Offline">
									<i class="fa fa-pencil fa-fw fa-md icon-pad-top"></i>
								</span>
								<span ng-switch-when="Online">
									<i class="fa fa-laptop fa-fw fa-md icon-pad-top"></i>
								</span>
								<span ng-switch-when="Discussion">
									<i class="fa fa-users fa-fw fa-md icon-pad-top"></i>
								</span>
								<span class="icon-label">{{relationship.activity.category}}</span>
							</div>
							<div class="col-xs-1 col-center">
								<span ng-show="notEmpty('{{relationship.activity.image}}')">
									<img ng-src="{{relationship.activity.image}}" class="icon-pad-top img-thumbnail img-responsive">
								</span>
							</div>
							<div class="col-xs-7">
								<h4>{{relationship.activity.name}}</h4>
								<p>{{relationship.activity.description}}</p>
								<p class="notes">{{relationship.activity.teaching_notes}}<p>
									<p ng-show="notEmpty({{relationship.activity.tags}})" ng-repeat="tag in relationship.activity.tags">
										<img ng-src="{{tag.logo}}" alt="tag.name" class="img-thumbnail img-responsive">
									</p>
								</div>
								<div class="col-xs-1">
									<span class="pull-right icon-pad-top">
										<span ng-show="notEmpty('{{relationship.activity.video_url}}')">
											<a href="{{relationship.activity.video_url}}" target="_blank" ><i class="btn fa fa-youtube-play fa-btn" ng-mouseenter="videoLabel = true" ng-mouseleave="videoLabel = false"></i></a>
										</span>
										<span ng-show="notEmpty({{relationship.activity.materials}})">
											<!-- TODO: Modal window with materials-->
											<a><i class="btn fa fa-file-o fa-btn" ng-mouseenter="materialsLabel = true" ng-mouseleave="materialsLabel = false" ng-click="activityMaterials()"></i></a>
										</span>
										<span ng-show="notEmpty({{relationship.activity.resources}})">
											<!-- TODO: Modal window with resources / helpful tips-->
											<a><i class="btn fa fa-question-circle fa-btn" ng-mouseenter="resourcesLabel = true" ng-mouseleave="resourcesLabel = false" ng-click="activityResources()"></i></a>
										</span>
										<span ng-show="notEmpty({{relationship.activity.relationships}})">
											<!-- TODO: Modal window with related activities. Can open in new window or jump to appropriate section-->
											<a><i class="btn fa fa-plus fa-btn" ng-mouseenter="relatedLabel = true" ng-mouseleave="relatedLabel = false" ng-click="relatedActivities()"></i></a>
										</span>
									</span>
									<span ng-show="materialsLabel">Materials</span>
									<span ng-show="videoLabel">View video</span>
									<span ng-show="resourcesLabel">Helpful Hints</span>
									<span ng-show="relatedLabel">Related activities</span>
								</div>
							</div>
							<hr class="no-margin">
						</div>
						<div id="add-activity" class="container row">
						<div class="col-xs-offset-10 col-xs-1">
							<i class="pull-right btn fa fa-plus-circle fa-btn" ng-click="newActivity()"></i>
						</div>
						</div>
					</accordion-group>
					<div class="row no-pad">
						<hr class="no-margin">
					</div>
				</div>	
			</div>
		</accordion>
	</div>

<div id="add-curriculum" class="container">
	<i class="pull-right btn fa fa-plus-circle fa-btn" ng-click="newCurriculum()"></i>
</div>

</div>

{% endverbatim %}

{% endblock %}

{% block js %}
{{ block.super }}
{% load staticfiles%}
<script src="{% static "js/app.curricula.js" %}"></script>

<script>
	// Add the CSRF token
	var app = angular.module('lms.app.curricula');
	app.config(['$httpProvider', function($httpProvider) {
		$httpProvider.defaults.headers.common['X-CSRFToken'] = '{{ csrf_token|escapejs }}';
	}]);
</script>
{% endblock %}